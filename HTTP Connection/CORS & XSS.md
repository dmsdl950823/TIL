# CORS & XSS

## CORS - Cross-Origin Resource Sharing

### 정의
추가 HTTP 헤더를 사용하여 한곳에서 실행중인 웹 애플리케이션은 다른 출처의 선택한 자원에 접근할 수 있는 권한을 부여하도록 브라우저에 알려주는 체제. <br>
웹 애플리케이션은 리소스가 자신의 출처(도메인, 프로토콜, 포트) 와 다를때 교차출처 HTTP 요청을 실행합니다.<br>
추가적으로, 서버 데이터에 부수효과(side effect)를 일으킬 수 있는 HTTP요청 메서드에 대해(`GET` 이외의 메서드),<br>
CORS 명세는 브라우저가 요청을 `OPTION` 메서드로 사전전달(preflight) 하여 지원하는 메서드를 요청하고, 서버의 '허가'가 떨어지면 실제 요청을 보내도록 요구합니다.
<br>
또한 서버는 클라이언트에게 요청에 "인증정보" 를 함께 보내야 한다고 알려줄 수도 있습니다.
<br><br>
CORS 실패는 오류의 원인이지만, 보안상의 이유로 JS에서는 오류의 상세 정보에 접근할수 없으며, 정확히 어떤 것이 실패했는지 알아내려면 브라우저의 콘솔을 봐야합니다.


### CORS 를 사용하는 경우

1. `XMLHTTPRequest`와 `FetchAPI`를 호출할 경우
2. 서버가 `TrueType fonts`를 사용할 경우 - 웹폰트(`@font-face` 사용시)
3. WebGL 텍스쳐 사용시
4. drawImage()를 사용해 캔버스에 그린 이미지/비디오 프레임
5. 이미지로부터 추출하는 CSS Shapes


### CORS 해결하기

1. JSONP 를 통한 해결
* HTML의 script 요소로부터 요청되는 호출에 보안상 정책이 적용 안되는 것을 이용
* jQuery에서 ajax 사용시 type에 jsonp로 요청하면 됨.
* 단점 - `GET` 방식에서만 사용 가능

2. Proxy 서버를 두는 방법

3. `jQuery.ajaxPrefilter()` 사용
* 1번과 흡사하지만 ajax에는 json으로 설정해두고 통신시 prefilter에서 JSONP로 속여서 전송하는 방식
* jQuery 1.5 이상 - crossDomain 옵션도 true 설정

4. 서버에서 Access-Control-allow-origin 설정을 통한 요청 허용

-----------------

## XSS - Cross-Site-Scripting

XSS는 웹 해킹 공격중 하나를 의미한다. <br>
게시판이나 웹 메일 등에 JS같은 스크립트 코드를 삽입해 개발자가 고려하지 않은 기능이 작동하게 하는 치명적일 수 있는 공격이다. <br>

### XSS 공격의 종류

1. Reflected XSS
  > 취약점이 존재하는 페이지를 탐색한 후, XSS 공격을 위한 스크립트가 포함된 URL을 공격 대상자에게 노출시키는 방법으로 공격을 수행할 수 있다.

2. Stored XSS
  > 웹사이트의 게시판에 스크립트를 삽입하는 공격방식


### XSS 의 위험성

1. 쿠키 정보 및 세션 ID 획득
  > 만약 세션 ID 등을 쿠키에 포함하는 경우, XSS 공격을 통해서 페이지 사용자의 세션 ID를 획득해 공격자가 불법적으로 정상 사용자인 척 가장할 수 있다.

2. 시스템 관리자 권한 획득
  > XSS 취약점이 있는 웹 서버에 다양한 악성 데이터를 포함시킨 후, 사용자의 브라우저가 악성 데이터를 실행하게 할 수 있다.<br>
    만약 회사 등 조직의 개인 PC가 해킹될 경우, 조직 내부로 악성코드가 이동해 내부의 중요 정보가 탈취될 수 있다.
    
3. 악성코드 다운로드
  > XSS 공격은 악성 스크립트 자체로 악성 프로그램을 다운로드 할 수는 없다. <br>
    하지만, 사용자가 악성 스크립트가 있는 URL을 클릭하도록 해 프로그램을 다운받는 사이트로 리다이렉트 하거나 트로이목마 프로그램을 다운로드 하도록 유도할 수 있다.
    
4. 거짓 페이지 노출
  > XSS 공격에 취약할 경우, <script> <img> 등 과 같은 태그를 사용해 페이지와는 전혀 상관 없는 페이지를 표시할 수 있다. <br>
    이를 통해 개인정보 유출 등의 위험이 있다.


### XSS 방지

<strong> XSS공격은 IPS, IDS, 방화벽 등으로도 방지할 수 없다. <br>
  때문에 단순히 문자를 필터링 하는 등의 방법만이 존재한다.
</strong>

1. script 문자 필터링

2. htmlentities 사용





첫달은 18일 - 이후 11일









